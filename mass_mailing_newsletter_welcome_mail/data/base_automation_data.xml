<?xml version="1.0" encoding="utf-8"?>
<odoo noupdate="1">
    <data>
        <record id="email_template" model="mail.template">
            <field name="name">Welcome mail to newsletter subscribers</field>
            <field name="model_id" ref="mass_mailing.model_mail_mass_mailing_contact"/>
            <field name="use_default_to" eval="True"/>
            <field name="lang">${object.env.context.get("lang")}</field>
            <field name="subject">Welcome to the mailing list ${object.list_id.name}</field>
            <field name="body_html" type="html">
                <div>Dear <b>${object.name}</b>,
                    <br/>
                    <h3>Thanks for signing up for our newsletter!</h3>
                    <p>Regards,</p>
                </div>
            </field>
        </record>
    </data>

    <data>
        <record id="automated_action" model="base.automation">
            <field name="name">Send Welcome Mail to new subscribers on Newsletter</field>
            <field name="model_id" ref="mass_mailing.model_mail_mass_mailing_contact"/>
            <field name="state">email</field>
            <field name="trigger">on_create</field>
            <field name="active" eval="True"/>
            <field name="template_id" ref="email_template"/>
            <field name="filter_domain" eval="[['list_ids', '=', ref('mass_mailing.mass_mail_list_1')]]"/>
        </record>

    </data>
</odoo>
